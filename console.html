<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>console.log</title>
</head>
<body>
        <style>
            .output-li{
                margin: 5px 0;
                padding: 5px;
                border-top: 1px solid #EEEFEE;
                white-space: pre-wrap;
                padding-bottom: 0;
                font-family: monospace;
                font-size: 14px;
                list-style: none;
                line-height: 20px;
            }
            .output-li .common{
                color: #212121;
            }
            .output-li .string{
                color: #C41A16;
            }
            .output-li .number{
                color: #1B00D1;
            }
            .output-li .null{
                color: #808080;
            }
            .output-li .object{
                color: #660066;
                font-style: italic;
            }
            .output-li .timeLine{
                color: #B7B7B7;
            }
        </style>
        <script>
            var log = console.log;
            var util = {
                type: function(variable){
                    return Object.prototype.toString.call(variable).slice(8, -1);
                }
            }
            var console = {
                log:function (msg){
                    var li = document.createElement('li');
                    li.className = 'output-li';
                    var timeLine = this._createTime();
                    li.appendChild(timeLine);
                    if(util.type(msg) === 'String'){
                        var str = this._createString(msg);
                        li.appendChild(str);
                    }else if(util.type(msg) === 'Number'){
                        var num = this._createNumber(msg);
                        li.appendChild(num);
                    }else if(util.type(msg) === 'Null' || util.type(msg) === 'Undefined'){
                        var nulld = this._createNull(msg);
                        li.appendChild(nulld);
                    }else if(util.type(msg) === 'Array'){
                        var array = this._createArray(msg);
                        li.appendChild(array);
                    }else if(util.type(msg) === 'Object'){
                        var obj = this._createObject(msg);
                        li.appendChild(obj);
                    }
                    document.body.appendChild(li);
                },
                _createString: function(str){
                    var fragment = document.createDocumentFragment('fragment')
                    var start = this._createCommon('"');
                    var end = this._createCommon('"');
                    var string = document.createElement('span');
                    string.className = 'string';
                    string.innerHTML = str;
                    fragment.appendChild(start);
                    fragment.appendChild(string);
                    fragment.appendChild(end);
                    return fragment;
                },
                _createNumber: function(num){
                    var number = document.createElement('span');
                    number.className = 'number';
                    number.innerHTML = num;
                    return number;
                },
                _createNull: function(msg){
                    var nulld = document.createElement('span');
                    nulld.className = 'null';
                    if(util.type(msg) === 'Null'){
                        nulld.innerHTML = 'null';
                    }else if(util.type(msg) === 'Undefined'){
                        nulld.innerHTML = 'undefined';
                    }
                    return nulld;
                },
                _createArray: function(arr){
                    var start = this._createCommon('[');
                    var end = this._createCommon(']');
                    var fragment = document.createDocumentFragment('fragment');
                    fragment.appendChild(start);
                    if(arr.length !== 0){
                        var len = 0;
                        var undefined_repeat_pos = -1;var  null_repeat_pos = -1;
                        var undefined_repeat_times = 1;var null_repeat_times = 1;
                        var undefined_hasRepeat = false;var null_hasRepeat = false;
                        /* ergodic the Array's empty index*/
                        for(var key of arr){ // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of
                            len++;
                            if(util.type(key) === 'Number'){
                                var num = this._createNumber(key);
                                fragment.appendChild(num);
                            }else if(util.type(key) === 'String'){
                                var str = this._createString(key);
                                fragment.appendChild(str);
                            }else if(util.type(key) === 'Undefined'){
                                var nulld = this._createNull(key);
                                if(len -1 !== 0 && undefined_repeat_pos + 1 === len -1){
                                    undefined_repeat_times++;
                                }
                                if(undefined_repeat_times === 1 || undefined_repeat_pos === -1){
                                    fragment.appendChild(nulld);
                                    if(arr[len-1] === arr[len]){
                                        undefined_hasRepeat = true;
                                    }else{
                                        undefined_hasRepeat = false;
                                    }
                                    
                                }else if(undefined_repeat_times !== 1 && (len === arr.length || arr[len-1] !== arr[len])){
                                    var repeatSpan = document.createElement('span');
                                    repeatSpan.className = 'null';
                                    repeatSpan.innerHTML = ` × ${undefined_repeat_times}`;
                                    repeatSpan.style.fontSize='12px'
                                    fragment.appendChild(repeatSpan);
                                    undefined_repeat_times = 1;
                                    undefined_hasRepeat = false;
                                }
                                undefined_repeat_pos = len - 1;
                            }else if(util.type(key) === 'Null'){
                                var nulld = this._createNull(key);
                                if(len -1 !== 0 && null_repeat_pos + 1 === len -1){
                                    null_repeat_times++;
                                }
                                if(null_repeat_times === 1 || null_repeat_pos === -1){
                                    fragment.appendChild(nulld);
                                    if(arr[len-1] === arr[len]){
                                        null_hasRepeat = true;
                                    }else{
                                        null_hasRepeat = false;
                                    }
                                }else if(null_repeat_times !== 1 && (len === arr.length || arr[len-1] !== arr[len])){
                                    var repeatSpan = document.createElement('span');
                                    repeatSpan.className = 'null';
                                    repeatSpan.innerHTML = ` × ${null_repeat_times}`;
                                    repeatSpan.style.fontSize='12px'
                                    fragment.appendChild(repeatSpan);
                                    null_repeat_times = 1;
                                    null_hasRepeat = false;
                                }
                                null_repeat_pos = len - 1;
                            }
                            if(len !== arr.length && undefined_repeat_times === 1 && !undefined_hasRepeat && null_repeat_times === 1 && !null_hasRepeat ){
                                var comma = this._createComma();
                                fragment.appendChild(comma);
                            }
                        }
                    }
                    fragment.appendChild(end);
                    return fragment;
                },
                _createTime: function(){
                    var time = new Date();
                    var timeSpan = document.createElement('span');
                    timeSpan.className = 'timeLine';
                    timeSpan.innerHTML = `${time.getHours()}:${time.getMinutes() < 10 ? '0' + time.getMinutes() : time.getMinutes()}:${time.getSeconds() < 10 ? '0' + time.getSeconds() : time.getSeconds()}.${time.getMilliseconds() < 10 ? '00' + time.getMilliseconds() : (time.getMilliseconds() < 100 ? '0' + time.getMilliseconds() : time.getMilliseconds())}&nbsp;`;
                    return timeSpan;
                },
                _createCommon: function(innerHTML){
                    var common = document.createElement('span');
                    common.className = 'common';
                    common.innerHTML = innerHTML;
                    return common;
                },
                _createComma: function(){
                    var comma = document.createElement('span');
                    comma.className = 'commom';
                    comma.innerHTML = ', ';
                    return comma;
                },
                _createSpace: function(times=1){
                    var space = ''
                    var spaceSpan = document.createElement('span');
                    for(var i = 0;i < times; i++){
                        space+='&nbsp;'
                    }
                    spaceSpan.innerHTML = space;
                    return spaceSpan;
                },
                _createObject: function(obj){
                    var start = this._createCommon('[object Object] {');
                    var spaceSpan = this._createSpace(7)
                    var end = this._createCommon('}');
                    var fragment = document.createDocumentFragment('fragment');
                    fragment.appendChild(start);
                    var br = document.createElement('br')
                    for(var key in obj){
                        fragment.appendChild(br)
                        fragment.appendChild(spaceSpan)
                        log(key)
                    }

                    fragment.appendChild(end);
                    log(this._isEmptyObject(obj))
                    return fragment;
                },
                _isEmptyObject:function(obj){
                    return Object.getOwnPropertyNames(obj).length > 0 ? true : false;
                }
            }
            var arr = [1, 2, 3];
            var obj = {name: "jack", age: 23};
            var arr = [,,1,,,,5,,"2", null, null, null, undefined, null,,,];// 
            var obj = {name: "jack", age: 23};
            function fun(a, b){
                console.log(a, b);
            }
            console.log("f");
            console.log(1);
            console.log(null);
            console.log(undefined);
            console.log(arr);
            console.log(obj);
            console.log({});
            // console.log(obj);
            // console.log(fun);
            
            log(arr)
        </script>
</body>
</html>